proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
# Ajustar espacio de trabajo:
rm(list=ls())
options(scipen=999)
#Cargar base de datos:
latinobarometro2020 <- read_sas("C:/Users/Alumno/Documents/GitHub/Practico mauricio js/Practico3/Input/Latinobarometro_2020_Esp.sas7bdat", encoding = "UTF-8")
#Dimension de la base
dim(latinobarometro2020)
View(latinobarometro2020)
# seleccionar variables a utilizar
find_var(data = latinobarometro2020,"Confianza")
proc_data <- latinobarometro2020 %>% select(p13st_e, #confianza en el gobierno
p13st_d,  #confianza en el congreso
p13st_f,  #confianza en el poder judicial
p13st_g,  #confianza en los partidos políticos
reeduc_1, #nivel educacional
sexo, #sexo
edad, #edad
idenpa) #pais
#Comprobar
names(proc_data)
# Obtener atributos de las variables
sjlabelled::get_label(proc_data)
# Filtramos datos unicamente de Chile
proc_data <- proc_data %>% dplyr::filter(idenpa==152)
dim(proc_data)
# 4 Procesamiento de variables
# a. Descriptivo
frq(proc_data$p13st_e)
# B. recodificacion
proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
install.packages("sjlabelled")
library("sjlabelled")
# B. recodificacion
proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
# B. recodificacion
proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
# Ajustar espacio de trabajo:
rm(list=ls())
pacman::p_load(dplyr, sjmisc, car, stargazer)
library("dplyr")
install.packages("dplyr")
install.packages("dplyr")
library("haven")
install.packages("sjlabelled")
install.packages("sjlabelled")
pacman::p_load(dplyr, sjmisc, car, stargazer)
library("dplyr")
library("haven")
library("sjlabelled")
#Cargar base de datos:
latinobarometro2020 <- read_sas("C:/Users/Alumno/Documents/GitHub/Practico mauricio js/Practico3/Input/Latinobarometro_2020_Esp.sas7bdat", encoding = "UTF-8")
#Dimension de la base
dim(latinobarometro2020)
View(latinobarometro2020)
# seleccionar variables a utilizar
find_var(data = latinobarometro2020,"Confianza")
proc_data <- latinobarometro2020 %>% select(p13st_e, #confianza en el gobierno
p13st_d,  #confianza en el congreso
p13st_f,  #confianza en el poder judicial
p13st_g,  #confianza en los partidos políticos
reeduc_1, #nivel educacional
sexo, #sexo
edad, #edad
idenpa) #pais
#Comprobar
names(proc_data)
# Obtener atributos de las variables
sjlabelled::get_label(proc_data)
dim(proc_data)
# Filtramos datos unicamente de Chile
proc_data <- proc_data %>% dplyr::filter(idenpa==152)
dim(proc_data)
# 4 Procesamiento de variables
# a. Descriptivo
frq(proc_data$p13st_e)
# B. recodificacion
proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
proc_data$p13st_d <- recode(proc_data$p13st_d, "c(-2,-1)=NA")
proc_data$p13st_f <- recode(proc_data$p13st_f, "c(-2,-1)=NA")
proc_data$p13st_g <- recode(proc_data$p13st_g, "c(-2,-1)=NA")
proc_data <- proc_data %>% set_na(., na = c(-2, -1))
proc_data$p13st_e <- recode(proc_data$p13st_e, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_d <- recode(proc_data$p13st_d, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_f <- recode(proc_data$p13st_f, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_g <- recode(proc_data$p13st_g, "1=3; 2=2; 3=1; 4=0")
proc_data <- proc_data %>% rename("conf_gob"=p13st_e, # Confianza en el gobierno
"conf_cong"=p13st_d, # Confianza en el congreso
"conf_jud"=p13st_f, # Confianza en el Poder Judicial
"conf_partpol"=p13st_g) # Confianza en los partidos políticos
[1] "Confianza: Gobierno"
"Confianza: Gobierno"
get_label(proc_data$conf_cong)
get_label(proc_data$conf_jud)
proc_data$conf_partpol  <- set_label(x = proc_data$conf_partpol, label = "Confianza: Partidos politicos")
proc_data <- proc_data %>% set_na(., na = c(-2, -1))
summary(proc_data$conf_inst)
# Ajustar espacio de trabajo:
rm(list=ls())
install.packages("pacman")
pacman::p_load(dplyr, sjmisc, car, stargazer)
library("dplyr")
install.packages("dplyr")
install.packages("haven")
library("haven")
install.packages("sjlabelled")
library("sjlabelled")
install.packages("dplyr")
options(scipen=999)
#Cargar base de datos:
latinobarometro2020 <- read_sas("C:/Users/Alumno/Documents/GitHub/Practico mauricio js/Practico3/Input/Latinobarometro_2020_Esp.sas7bdat", encoding = "UTF-8")
#Dimension de la base
dim(latinobarometro2020)
View(latinobarometro2020)
# seleccionar variables a utilizar
find_var(data = latinobarometro2020,"Confianza")
proc_data <- latinobarometro2020 %>% select(p13st_e, #confianza en el gobierno
p13st_d,  #confianza en el congreso
p13st_f,  #confianza en el poder judicial
p13st_g,  #confianza en los partidos políticos
reeduc_1, #nivel educacional
sexo, #sexo
edad, #edad
idenpa) #pais
#Comprobar
names(proc_data)
# Obtener atributos de las variables
sjlabelled::get_label(proc_data)
# Filtramos datos unicamente de Chile
proc_data <- proc_data %>% dplyr::filter(idenpa==152)
dim(proc_data)
# 4 Procesamiento de variables
# a. Descriptivo
frq(proc_data$p13st_e)
# B. recodificacion
proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
proc_data$p13st_d <- recode(proc_data$p13st_d, "c(-2,-1)=NA")
proc_data$p13st_f <- recode(proc_data$p13st_f, "c(-2,-1)=NA")
proc_data$p13st_g <- recode(proc_data$p13st_g, "c(-2,-1)=NA")
proc_data <- proc_data %>% set_na(., na = c(-2, -1))
proc_data$p13st_e <- recode(proc_data$p13st_e, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_d <- recode(proc_data$p13st_d, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_f <- recode(proc_data$p13st_f, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_g <- recode(proc_data$p13st_g, "1=3; 2=2; 3=1; 4=0")
proc_data <- proc_data %>% rename("conf_gob"=p13st_e, # Confianza en el gobierno
"conf_cong"=p13st_d, # Confianza en el congreso
"conf_jud"=p13st_f, # Confianza en el Poder Judicial
"conf_partpol"=p13st_g) # Confianza en los partidos políticos
proc_data$conf_cong  <- set_label(x = proc_data$conf_cong, label = "Confianza: Congreso")
get_label(proc_data$conf_cong)
proc_data$conf_jud  <- set_label(x = proc_data$conf_jud, label = "Confianza: Poder judicial")
get_label(proc_data$conf_jud)
proc_data$conf_partpol  <- set_label(x = proc_data$conf_partpol, label = "Confianza: Partidos politicos")
get_label(proc_data$conf_partpol)
proc_data$conf_inst <- (proc_data$conf_gob+proc_data$conf_cong+proc_data$conf_jud+proc_data$conf_partpol)
summary(proc_data$conf_inst)
get_label(proc_data$conf_inst)
proc_data$conf_inst  <- set_label(x = proc_data$conf_inst, label = "Confianza en instituciones")
#Descriptivo
frq(proc_data$conf_gob)
frq(proc_data$conf_cong)
frq(proc_data$conf_inst)
proc_data$conf_gob <- set_labels(proc_data$conf_gob,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$conf_cong <- set_labels(proc_data$conf_cong,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$conf_jud <- set_labels(proc_data$conf_jud,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$conf_partpol <- set_labels(proc_data$conf_partpol,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
frq(proc_data$conf_gob)
# 4.2
frq(proc_data$reeduc_1)
# No tenemos cambiado las categorias de esta variable. Además, no tenemos valores NA.
# Combinamos categorias, tenemos 7 pero dejaremos 3:
proc_data$reeduc_1 <- car::recode(proc_data$reeduc_1, "c(1,2,3)=1; c(4,5)=2; c(6,7)=3")
frq(proc_data$reeduc_1)
# Ahora cambiamos los nombres de las categorias
proc_data$reeduc_1 <- set_labels(proc_data$reeduc_1,
labels=c( "Educacion basica"=1,
"Educacion media"=2,
"Educacion superior"=3))
proc_data <- rename(proc_data,"educacion"=reeduc_1)
get_label(proc_data$educacion)
proc_data$educacion <- set_label(x = proc_data$educacion,label = "Educación")
frq(proc_data$reeduc_1)
# Ahora cambiamos los nombres de las categorias
proc_data$reeduc_1 <- set_labels(proc_data$reeduc_1,
labels=c( "Educacion basica"=1,
"Educacion media"=2,
"Educacion superior"=3))
proc_data <- rename(proc_data,"educacion"=reeduc_1)
get_label(proc_data$educacion)
proc_data$educacion <- set_label(x = proc_data$educacion,label = "Educación")
frq(proc_data$reeduc_1)
# Ajustar espacio de trabajo:
rm(list=ls())
#Cargar base de datos:
latinobarometro2020 <- read_sas("C:/Users/Alumno/Documents/GitHub/Practico mauricio js/Practico3/Input/Latinobarometro_2020_Esp.sas7bdat", encoding = "UTF-8")
#Dimension de la base
dim(latinobarometro2020)
View(latinobarometro2020)
# seleccionar variables a utilizar
find_var(data = latinobarometro2020,"Confianza")
proc_data <- latinobarometro2020 %>% select(p13st_e, #confianza en el gobierno
p13st_d,  #confianza en el congreso
p13st_f,  #confianza en el poder judicial
p13st_g,  #confianza en los partidos políticos
reeduc_1, #nivel educacional
sexo, #sexo
edad, #edad
idenpa) #pais
#Comprobar
names(proc_data)
# Obtener atributos de las variables
sjlabelled::get_label(proc_data)
# Filtramos datos unicamente de Chile
proc_data <- proc_data %>% dplyr::filter(idenpa==152)
dim(proc_data)
# 4 Procesamiento de variables
# a. Descriptivo
frq(proc_data$p13st_e)
# B. recodificacion
proc_data$p13st_e <- recode(proc_data$p13st_e, "c(-2,-1)=NA")
proc_data$p13st_d <- recode(proc_data$p13st_d, "c(-2,-1)=NA")
proc_data$p13st_f <- recode(proc_data$p13st_f, "c(-2,-1)=NA")
proc_data$p13st_g <- recode(proc_data$p13st_g, "c(-2,-1)=NA")
proc_data <- proc_data %>% set_na(., na = c(-2, -1))
proc_data$p13st_e <- recode(proc_data$p13st_e, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_d <- recode(proc_data$p13st_d, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_f <- recode(proc_data$p13st_f, "1=3; 2=2; 3=1; 4=0")
proc_data$p13st_g <- recode(proc_data$p13st_g, "1=3; 2=2; 3=1; 4=0")
proc_data <- proc_data %>% rename("conf_gob"=p13st_e, # Confianza en el gobierno
"conf_cong"=p13st_d, # Confianza en el congreso
"conf_jud"=p13st_f, # Confianza en el Poder Judicial
"conf_partpol"=p13st_g) # Confianza en los partidos políticos
proc_data$conf_cong  <- set_label(x = proc_data$conf_cong, label = "Confianza: Congreso")
get_label(proc_data$conf_cong)
proc_data$conf_jud  <- set_label(x = proc_data$conf_jud, label = "Confianza: Poder judicial")
get_label(proc_data$conf_jud)
proc_data$conf_partpol  <- set_label(x = proc_data$conf_partpol, label = "Confianza: Partidos politicos")
get_label(proc_data$conf_partpol)
proc_data$conf_inst <- (proc_data$conf_gob+proc_data$conf_cong+proc_data$conf_jud+proc_data$conf_partpol)
summary(proc_data$conf_inst)
get_label(proc_data$conf_inst)
proc_data$conf_inst  <- set_label(x = proc_data$conf_inst, label = "Confianza en instituciones")
#Descriptivo
frq(proc_data$conf_gob)
frq(proc_data$conf_cong)
frq(proc_data$conf_inst)
proc_data$conf_gob <- set_labels(proc_data$conf_gob,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$conf_cong <- set_labels(proc_data$conf_cong,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$conf_jud <- set_labels(proc_data$conf_jud,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
proc_data$conf_partpol <- set_labels(proc_data$conf_partpol,
labels=c( "Ninguna"=0,
"Poca"=1,
"Algo"=2,
"Mucha"=3))
#Revisamos las nuevas categorias
frq(proc_data$conf_gob)
frq(proc_data$conf_cong)
# 4.2
frq(proc_data$reeduc_1)
# No tenemos cambiado las categorias de esta variable. Además, no tenemos valores NA.
# Combinamos categorias, tenemos 7 pero dejaremos 3:
proc_data$reeduc_1 <- car::recode(proc_data$reeduc_1, "c(1,2,3)=1; c(4,5)=2; c(6,7)=3")
frq(proc_data$reeduc_1)
# Ahora cambiamos los nombres de las categorias
proc_data$reeduc_1 <- set_labels(proc_data$reeduc_1,
labels=c( "Educacion basica"=1,
"Educacion media"=2,
"Educacion superior"=3))
frq(proc_data$reeduc_1)
# Vamos a guardar la base
save(proc_data, file ="input/proc_data.sas7bdat")
# Vamos a transformar la variable educación en una variable categórica.
proc_data$reeduc_1 <- factor(proc_data$reeduc_1,
labels = c("Educación basica", "Educación Media", "Educación Superior"),
levels = c(1, 2, 3))
# Le ponemos un nombre más sustantivo a la variable
proc_data <- rename(proc_data, "educación"=reeduc_1)
pacman::p_load(dplyr, sjmisc, car, stargazer, haven, sjlabelled)
# Le ponemos un nombre más sustantivo a la variable
proc_data <- rename(proc_data, "educación"=reeduc_1)
# Además de cambiarle el nombre, le cambiamos la etiqueta
get_label(proc_data$educacion)
View(proc_data)
get_label(proc_data$educacion)
get_label(proc_data$educacion)
proc_data$educación <- set_label(x = proc_data$educación, label = "Educación")
# 4.3 sexo
frq(proc_data$sexo)
proc_data$sexo <- car::recode(proc_data$sexo, "1=0;2=1")
#Etiquetado
proc_data$sexo <- factor(proc_data$sexo
labels=c("Hombre",
#Etiquetado
proc_data$sexo <- factor(proc_data$sexo,
labels=c("Hombre",
"Mujer"),
levels=c(0,1))
get_label(proc_data$sexo)
proc_data$sexo <-set_label(x = proc_data$sexo, label = "Sexo")
frq(proc_data$sexo)
#Edad
frq(proc_data$edad)
get_label(proc_data$edad)
#Librerías
pacman::p_load(sjlabelled, dplyr, stargazer, sjmisc, summarytools, kableExtra, sjPlot, corrplot, sessioninfo, ggplot2)
#Vamos a llamar la base de datos directo del sitio web:
load(url("https://github.com/Kevin-carrasco/R-data-analisis/raw/main/files/data/latinobarometro_total.RData"))
names(proc_data)
dim(proc_data)
#Tabla stargazer
stargazer(proc_data, type = "text")
#Tabla descriptiva con descr
sjmis::descr(proc_data)
#Tabla descriptiva con descr
sjmisc::descr(proc_data)
sjmisc::descr(proc_data,
show = c("label", "range", "mean", "sd", "NA.prc", "n"))%>%
kable(.,"markdown")
summarytools::dfSummary(proc_data, plain.ascii = FALSE)
view(dfSummary(proc_data, headings = FALSE))
#Vamos a eliminar los casos perdidos, pero vamos a guardar la base original
proc_data_original <-proc_data
dim(proc_data_original)
#Contamos el n° de datos perdidos
sum(is.na(proc_data))
# 4005 casos perdidos de 20204
#Ahora borramos los casos perdidos
proc_data <-na.omit(proc_data)
dim(proc_data)
#Ahora tenemos un total de 18765 casos y 9 variables.
#Durante este proceso, se borran las etiquetas de nuestras categorías, por ello, las vamos a recuperar
proc_data <-sjlabelled::copy_labels(proc_data, proc_data_original)
view(proc_data)
view(proc_data)
#3.2 visualización de las variables
ggplot()
ggplot(proc_data, aes(x = conf_inst))
proc_data %>% ggplot(aes(x = conf_inst)) +
geom_bar()
proc_data %>% ggplot(aes(x = conf_instt)) +
geom_bar(fill = "coral")
proc_data %>% ggplot(aes(x = conf_instt)) +
geom_bar(fill = "coral")
proc_data %>% ggplot(aes(x = conf_inst)) +
geom_bar(fill = "coral")
#Con este ultimo codigo cambiamos el color
proc_data %>% ggplot(aes(x = conf_inst)) +
geom_bar(fill = "coral")+
labs(title = "confianza en instituciones",
x = "confianza en instituciones",
y = "frecuencia")
#Con este ultimo codigo cambiamos el color
proc_data %>% ggplot(aes(x = conf_inst)) +
geom_bar(fill = "red")+
labs(title = "confianza en instituciones",
x = "confianza en instituciones",
y = "frecuencia")
#Con este ultimo codigo cambiamos el color
proc_data %>% ggplot(aes(x = conf_inst)) +
geom_bar(fill = "green")+
labs(title = "confianza en instituciones",
x = "confianza en instituciones",
y = "frecuencia")
#Creamos el gráfico 1
graph1 <- proc_data %>% ggplot(aes(x = conf_inst))+
geom_bar(fill = "green")+
labs(title = "Confianza en instituciones",
x = "Confianza en instituciones",
y = "Frecuencia")+
theme_bw()
view(graph1)
graph1
#Ahora lo guardamos como imágen.
ggsave(graph1, file="C:/Users/Alumno/Documents/GitHub/Practico3/output/graph1.png")
#Tables de contigencia para variables categóricas
sjt.xtab(proc_data$educacion, proc_data$sexo)
encoding = "UTF-8"
sjt.xtab(porc_data$educación, proc_data$sexo,
show.col.prc =TRUE,
show.summary = TRUE,
encoding = "UTF-8"
)
sjt.xtab(proc_data$educación, proc_data$sexo,
show.col.prc =TRUE,
show.summary = TRUE,
encoding = "UTF-8"
)
sjt.xtab(proc_data$educación, proc_data$sexo,
show.col.prc =TRUE,
show.summary = TRUE,
encoding = "UTF-8")
sjt.xtab(proc_data$educación, proc_data$sexo,
show.col.prc=TRUE,
show.summary=TRUE,
encoding = "UTF-8"
)
sjt.xtab(proc_data$educación, proc_data$sexo,
show.col.prc=TRUE,
show.summary=TRUE,
encoding = "UTF-8"
)
#Tables de contigencia para variables categóricas
sjt.xtab(proc_data$educacion, proc_data$sexo)
sjt.xtab(proc_data$educación, proc_data$sexo,
show.col.prc=TRUE,
show.summary=TRUE,
encoding = "UTF-8"
)
sjt.xtab(proc_data$educacion, proc_data$sexo,
show.col.prc=TRUE,
show.summary=TRUE,
encoding = "UTF-8"
)
#Tablas de promedio de una variable continua por una categóricas
tapply(proc_data$conf_inst, proc_data$educacion, mean)
proc_data %>% #Se especifica la base de datos
select(conf_inst, educacion) %>% #se seleccionan las variables
dplyr::group_by(Educación=sjlabelled::as_label(educacion)) %>% #se agrupan por la variable categórica y se usan etiquetas con as_label
dplyr::summarise(Obs.=n(), Promedio=mean(conf_inst), SD=sd(conf_inst)) %>% #se agregan las operaciones a presentar en la tabla
kable(, format = "markdown")
graph <- ggplot(proc_data, aes(x =educacion, y = conf_inst)) +
geom_boxplot() +
labs(x = "Educación", y = "Confianza en instituciones") +
theme_minimal()
graph
#Guardamos el codigo de cajas
ggsave(graph, file="C:/Users/Alumno/Documents/GitHub/Practico3/output/graph.png")
#Bastante feo el gráfico la verdad asi que hacemos otro
ggplot(proc_data, aes(x =educacion, y = conf_inst)) +
geom_point() +
labs(x = "Educación", y = "Confianza en instituciones") +
theme_minimal()
#haremos un objeto nuevo en función de esto
datos <- proc_data %>% group_by(educacion) %>%
summarise(promedio = mean(conf_inst))
#Ahora si hacemos el gráfico
ggplot(datos, aes(x =educacion, y =promedio))+
geom_point()+
labs(x = "Educación", y = "Confianza en instituciones")+
theme_minimal()+
ylim(0,12)
# La info es más precisa en este caso pero como los promedios son similares no tiene tanto sentido
proc_data$idenpa <- factor(proc_data$idenpa,
labels=c("Argentina",
"Bolivia",
"Brasil",
"Chile",
"Colombia",
"Costa Rica",
"Cuba",
"República Dominicana",
"Ecuador",
"El Salvador",
"Guatemala",
"Honduras",
"México",
"Nicaragua",
"Panamá",
"Paraguay",
"Uruguay",
"Venezuela"),
levels=c("32",
"68",
"76",
"152",
"170",
"188",
"214",
"218",
"222",
"320",
"340",
"484",
"558",
"591",
"600",
"604",
"858",
"862"))
graph_box <- ggplot(proc_data, aes(x =idenpa, y = conf_inst))+
geom_boxplot()+
labs(x = "País", y = "Confianza en instituciones") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
